<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Admin Dashboard - Aplyfly{% endblock %}</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="h-full bg-slate-950 text-slate-100">
    <div x-data="{ sidebarOpen: true }" class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside :class="sidebarOpen ? 'w-64' : 'w-20'" 
               class="bg-slate-900 border-r border-slate-800 transition-all duration-300 flex flex-col">
            <!-- Logo -->
            <div class="p-6 border-b border-slate-800 flex items-center justify-between">
                <div x-show="sidebarOpen" class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-cyan-500 to-blue-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-crown text-white"></i>
                    </div>
                    <div>
                        <h1 class="font-bold text-lg text-white">Admin</h1>
                        <p class="text-xs text-slate-400">Panel de Control</p>
                    </div>
                </div>
                <button @click="sidebarOpen = !sidebarOpen" 
                        class="text-slate-400 hover:text-white transition-colors">
                    <i class="fas" :class="sidebarOpen ? 'fa-angles-left' : 'fa-angles-right'"></i>
                </button>
            </div>
            
            <!-- User Info -->
            <div class="p-4 border-b border-slate-800">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full bg-gradient-to-br from-cyan-400 to-blue-500 flex items-center justify-center text-white font-bold">
                        {% if user.avatar %}
                            <img src="{{ user.avatar.url }}" alt="Avatar" class="w-full h-full rounded-full object-cover">
                        {% else %}
                            {{ user.first_name.0|default:user.email.0|upper }}
                        {% endif %}
                    </div>
                    <div x-show="sidebarOpen" class="flex-1 min-w-0">
                        <p class="text-sm font-semibold text-white truncate">
                            {{ user.get_full_name|default:user.email }}
                        </p>
                        <p class="text-xs text-slate-400">Administrador</p>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
                <a href="{% url 'admin_panel:dashboard' %}" 
                   class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-300 hover:bg-slate-800 hover:text-cyan-400 transition-all {% if request.resolver_match.url_name == 'dashboard' %}bg-slate-800 text-cyan-400{% endif %}">
                    <i class="fas fa-home w-5"></i>
                    <span x-show="sidebarOpen">Dashboard</span>
                </a>
                
                <a href="{% url 'admin_panel:projects' %}" 
                   class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-300 hover:bg-slate-800 hover:text-cyan-400 transition-all {% if 'projects' in request.path %}bg-slate-800 text-cyan-400{% endif %}">
                    <i class="fas fa-briefcase w-5"></i>
                    <span x-show="sidebarOpen">Proyectos</span>
                </a>
                
                <a href="{% url 'admin_panel:clients' %}" 
                   class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-300 hover:bg-slate-800 hover:text-cyan-400 transition-all {% if 'clients' in request.path %}bg-slate-800 text-cyan-400{% endif %}">
                    <i class="fas fa-users w-5"></i>
                    <span x-show="sidebarOpen">Clientes</span>
                </a>
                
                <div class="border-t border-slate-800 my-4"></div>
                
                <a href="/" 
                   class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-300 hover:bg-slate-800 hover:text-cyan-400 transition-all">
                    <i class="fas fa-globe w-5"></i>
                    <span x-show="sidebarOpen">Ver Sitio Web</span>
                </a>
                
                <a href="{% url 'clients:logout' %}" 
                   class="flex items-center gap-3 px-4 py-3 rounded-lg text-slate-300 hover:bg-red-500/10 hover:text-red-400 transition-all">
                    <i class="fas fa-sign-out-alt w-5"></i>
                    <span x-show="sidebarOpen">Cerrar Sesión</span>
                </a>
            </nav>
        </aside>
        
        <!-- Main Content -->
        <div class="flex-1 flex flex-col overflow-hidden">
            <!-- Top Bar -->
            <header class="bg-slate-900/50 backdrop-blur-sm border-b border-slate-800 px-8 py-4">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-100">{% block page_title %}Dashboard{% endblock %}</h2>
                        <p class="text-slate-400 text-sm">{% block page_subtitle %}Panel de administración{% endblock %}</p>
                    </div>
                    
                    <div class="flex items-center gap-4">
                        <!-- Notifications -->
                        <button class="relative p-2 text-slate-400 hover:text-cyan-400 transition-colors">
                            <i class="fas fa-bell text-xl"></i>
                            <span class="absolute top-0 right-0 w-2 h-2 bg-red-500 rounded-full"></span>
                        </button>
                        
                        <!-- Quick Actions -->
                        <div x-data="{ open: false }" class="relative">
                            <button @click="open = !open" 
                                    class="px-4 py-2 bg-cyan-500 text-white rounded-lg hover:bg-cyan-400 transition-all flex items-center gap-2">
                                <i class="fas fa-plus"></i>
                                <span>Acciones</span>
                            </button>
                            
                            <div x-show="open" 
                                 @click.away="open = false"
                                 x-cloak
                                 class="absolute right-0 mt-2 w-56 bg-slate-900 border border-slate-800 rounded-lg shadow-xl z-50">
                                <a href="{% url 'admin_panel:projects' %}?status=submitted" 
                                   class="block px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-cyan-400 transition-all">
                                    <i class="fas fa-inbox w-5"></i> Ver Proyectos Nuevos
                                </a>
                                <a href="{% url 'admin_panel:clients' %}" 
                                   class="block px-4 py-3 text-slate-300 hover:bg-slate-800 hover:text-cyan-400 transition-all">
                                    <i class="fas fa-user-plus w-5"></i> Ver Clientes
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Messages -->
            {% if messages %}
                <div class="px-8 py-4 space-y-2">
                    {% for message in messages %}
                        <div class="px-4 py-3 rounded-lg flex items-center gap-3 
                            {% if message.tags == 'success' %}bg-emerald-500/10 text-emerald-400 border border-emerald-500/20
                            {% elif message.tags == 'error' %}bg-red-500/10 text-red-400 border border-red-500/20
                            {% elif message.tags == 'warning' %}bg-yellow-500/10 text-yellow-400 border border-yellow-500/20
                            {% else %}bg-blue-500/10 text-blue-400 border border-blue-500/20{% endif %}">
                            <i class="fas 
                                {% if message.tags == 'success' %}fa-check-circle
                                {% elif message.tags == 'error' %}fa-exclamation-circle
                                {% elif message.tags == 'warning' %}fa-exclamation-triangle
                                {% else %}fa-info-circle{% endif %}"></i>
                            <span>{{ message }}</span>
                        </div>
                    {% endfor %}
                </div>
            {% endif %}
            
            <!-- Page Content -->
            <main class="flex-1 overflow-y-auto p-8">
                {% block content %}{% endblock %}
            </main>
        </div>
    </div>
    
    {% block extra_js %}{% endblock %}
</body>
</html>
